@model CmsExpressionOfInterestViewModel

<div class="feedback-prompt @Model.Component.AlteredMarginTopSpace @Model.Component.AlteredMarginBottomSpace">
    <div class="feedback-bg-color">
        <div class="govuk-width-container govuk-!-padding-1">
            <div class="govuk-grid-row">
                <div class="govuk-grid-column-full-width @Model.Component.AlteredPaddingTopSpace @Model.Component.AlteredPaddingBottomSpace">
                    <div style="border:1px dashed red; padding:10px;">
                        <h1>@Model.CTABannerText</h1>
                        <p>@Model.CTAButtonText</p>
                    </div>
                    <div style="border:1px dashed orange; padding:10px;">
                        <h1>@Model.FormHeader</h1>
                        @Html.Raw(Model.FormIntroHtml)
                    </div>
                    <div style="border:1px dashed yellow; padding:10px;">
                        <h1>@Model.ThankYouHeader</h1>
                        @Html.Raw(Model.ThankYouTextHtml)
                    </div>
                    <div style="border:1px dashed magenta; padding:10px;">
                        <form method="post" id="expresssion-of-interest-form">
                            <!-- __RequestVerificationToken autogenerated here -->
                        </form>
                        <a href="#" id="test-me" style="color:white;">Test</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    // TODO: Move to .js file
    document.getElementById("test-me").addEventListener('click', () => {
        const dto = {
            pageName: '@(Model.PageName)',
            userName: 'asdasd',
            userEmail: 'asdasd@mailme.com',
            userBusinessName: 'asdasd',
            userPhone: '435453',
            optInMarketingEmail: false,
            optInMarketingPhone: false,
            optInReadPrivacy: false
        };

        const requestVerificationToken =
            document.querySelector("form[id='expresssion-of-interest-form'] input[name='__RequestVerificationToken']").value;
        console.log(requestVerificationToken);
        fetch('/expression-of-interest', {
            method: 'POST',
            headers: {
                'Accept': 'application/json',
                'Content-Type': 'application/json',
                'X-XSRF-TOKEN': requestVerificationToken
            },
            body: JSON.stringify(dto)
        })
            .then((response) => {
                if (response.status === 200)
                    console.log(response);
                else
                    console.warn(response);
            })
            .catch(error => console.error(error)); // TODO: Remove all console log messages - show error using validation UI.
    });
</script>

